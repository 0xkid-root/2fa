# Two-Factor Authentication (2FA) Application

This project implements a complete Two-Factor Authentication system using React for the frontend and Node.js/Express for the backend. It uses Speakeasy for generating secrets and verifying tokens, and QRCode for generating scannable QR codes for easy setup with authenticator apps.

## Project Structure

```
.
├── Backend/
│   ├── index.js          # Main server file with API endpoints
│   ├── modal/User.js     # User schema and model for MongoDB
│   ├── package.json      # Backend dependencies
│   └── .gitignore        # Git ignore rules for backend
└── Frontend/
    ├── src/
    │   ├── App.jsx       # Main React component
    │   └── ...           # Other React files
    ├── package.json      # Frontend dependencies
    └── .gitignore        # Git ignore rules for frontend
```

## Features

- **2FA Setup**: Generate unique secrets for each user
- **QR Code Generation**: Create scannable QR codes for easy authenticator app setup
- **Token Verification**: Validate time-based one-time passwords (TOTP)
- **MongoDB Integration**: Store user emails and secret keys
- **Responsive UI**: Clean, user-friendly interface built with React

## Tech Stack

### Backend
- **Node.js** - JavaScript runtime environment
- **Express.js** - Web framework for Node.js
- **MongoDB** - NoSQL database for storing user data
- **Mongoose** - ODM for MongoDB
- **Speakeasy** - Two-factor authentication library
- **QRCode** - Library for generating QR codes

### Frontend
- **React** - JavaScript library for building user interfaces
- **Vite** - Fast build tool and development server
- **Axios** - Promise-based HTTP client for API requests

## Prerequisites

Before you begin, ensure you have the following installed:
- Node.js (v14 or higher)
- MongoDB (running locally or remote connection)
- npm or yarn package manager

## Installation

### Backend Setup

1. Navigate to the backend directory:
   ```bash
   cd Backend
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Update the MongoDB connection string in [Backend/index.js](file:///Users/apple/Desktop/mypersonal/2faproject/Backend/index.js#L11-L11) if needed:
   ```javascript
   mongoose.connect("mongodb://localhost:27017/twofa")
   ```

4. Start the backend server:
   ```bash
   npm run dev
   ```
   
   The backend will run on `http://localhost:9000`

### Frontend Setup

1. Navigate to the frontend directory:
   ```bash
   cd Frontend
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Start the development server:
   ```bash
   npm run dev
   ```
   
   The frontend will run on `http://localhost:5173` (default Vite port)

## Usage

1. Open the frontend application in your browser
2. Enter your email address
3. Click "Generate QR Code" to create a unique 2FA setup
4. Scan the QR code with your authenticator app (Google Authenticator, Authy, etc.)
5. Enter the OTP generated by your authenticator app
6. Click "Verify OTP" to validate the token

## API Endpoints

### POST `/generate`
Generates a new secret and QR code for 2FA setup
- Request body: `{ email: "user@example.com" }`
- Response: `{ qr: "data:image/png;base64,..." }`

### POST `/verify`
Verifies the OTP token provided by the user
- Request body: `{ email: "user@example.com", token: "123456" }`
- Response: `true` or `false`

## How It Works

1. When a user enters their email and clicks "Generate QR Code":
   - A unique secret is generated using Speakeasy
   - The secret is stored in MongoDB with the user's email
   - A QR code is generated containing the secret in otpauth format
   - The QR code is sent to the frontend for display

2. When a user scans the QR code with their authenticator app:
   - The app stores the secret and begins generating 6-digit tokens
   - Tokens change every 30 seconds based on TOTP algorithm

3. When a user enters a token and clicks "Verify OTP":
   - The backend retrieves the stored secret for the email
   - Uses Speakeasy to verify if the entered token is valid
   - Returns true/false based on token validity

## Security Considerations

- Secrets are stored in plain text in the database (should be encrypted in production)
- No rate limiting on verification attempts (should be implemented)
- No user session management (should be added for real applications)
- MongoDB connection string is hardcoded (should use environment variables)

## Future Improvements

- Add encryption for stored secrets
- Implement rate limiting for verification attempts
- Add user session management
- Improve error handling and validation
- Add unit tests
- Implement environment variables for configuration
- Add user registration and login functionality

## Contributing

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Create a pull request

## License

This project is licensed under the MIT License - see the LICENSE file for details.